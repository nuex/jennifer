#!/bin/sh
#
# jen-internal: Functions and variables shared by all scripts
#

# Ensure the template we're working with exists
__jen_ensure_directory() {
  dir="$1"; shift
  [ ! -d "$dir" ] && __jen_error "Target directory does not exist"
}

# Ensure jennifer template dir exists
__jen_ensure_template() {
  [ ! -d "$__jen_template_dir" ] && mkdir "$__jen_template_dir"
}

# Ensure template.jen exists
__jen_ensure_template_file() {
  dir="$1"; shift
  [ ! -f "$dir/template.jen" ] && __jen_error "template.jen file not found"
}

# Get the template name
# Throws an error if the name wasn't found
__jen_template_name() {
  dir="$1"; shift

  # Extract the name from the template file
  name="$(grep '^name ' "$dir/template.jen" | sed 's/name //')"

  # If no name was found, exit with an error
  [ ! "$name" ] && __jen_error "template name not found"

  echo "$name"
}

__jen_error() {
  echo -e ">>> ERROR: $*" >&2
  exit 1
}

__jen_template_dir="$HOME/.jen"

[ ! "$JEN_LIBDIR" ] &&
  __jen_error "Cannot find jennifer awk libraries. Please set \$JEN_LIBDIR."

__jen_awklib_dir="$JEN_LIBDIR"
